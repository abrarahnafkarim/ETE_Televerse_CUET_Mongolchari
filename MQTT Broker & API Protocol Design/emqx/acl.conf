%% AERAS ACL Configuration for EMQX
%% Format: {allow|deny, who, {publish|subscribe}, [{permission, topic}]}

%% Driver Permissions
{allow, {user, "driver_DRV-0423"}, publish, ["aeras/driver/DRV-0423/+"]}.
{allow, {user, "driver_DRV-0423"}, subscribe, ["aeras/block/+/request"]}.
{allow, {user, "driver_DRV-0423"}, subscribe, ["aeras/driver/DRV-0423/+"]}.
{allow, {user, "driver_DRV-0423"}, publish, ["aeras/system/heartbeat"]}.

%% Block Permissions
{allow, {user, "block_BLK-001"}, publish, ["aeras/block/BLK-001/request"]}.
{allow, {user, "block_BLK-001"}, publish, ["aeras/block/BLK-001/trip/+"]}.
{allow, {user, "block_BLK-001"}, subscribe, ["aeras/block/BLK-001/+"]}.
{allow, {user, "block_BLK-001"}, subscribe, ["aeras/driver/+/trip/status"]}.

%% Admin Permissions (read-only for most topics, write for commands)
{allow, {user, "admin_ADM-001"}, publish, ["aeras/admin/ADM-001/commands"]}.
{allow, {user, "admin_ADM-001"}, publish, ["aeras/admin/broadcast"]}.
{allow, {user, "admin_ADM-001"}, subscribe, ["aeras/+/+/+"]}.

%% System Service Permissions
{allow, {user, "system"}, publish, ["aeras/driver/+/points"]}.
{allow, {user, "system"}, publish, ["aeras/system/+"]}.
{allow, {user, "system"}, subscribe, ["aeras/+/+/+"]}.

%% Default deny all
{deny, all}.

